(function(e){function t(t){for(var s,c,a=t[0],o=t[1],l=t[2],f=0,d=[];f<a.length;f++)c=a[f],Object.prototype.hasOwnProperty.call(i,c)&&i[c]&&d.push(i[c][0]),i[c]=0;for(s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s]);u&&u(t);while(d.length)d.shift()();return n.push.apply(n,l||[]),r()}function r(){for(var e,t=0;t<n.length;t++){for(var r=n[t],s=!0,a=1;a<r.length;a++){var o=r[a];0!==i[o]&&(s=!1)}s&&(n.splice(t--,1),e=c(c.s=r[0]))}return e}var s={},i={category:0},n=[];function c(t){if(s[t])return s[t].exports;var r=s[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,c),r.l=!0,r.exports}c.m=e,c.c=s,c.d=function(e,t,r){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(c.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)c.d(r,s,function(t){return e[t]}.bind(null,s));return r},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],o=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var u=o;n.push([8,"chunk-vendors"]),r()})({0:function(e,t){},"025e":function(e,t,r){"use strict";function s(e,t,r){if(!t)return!0;for(var s=0;s<t.length;s++)for(var i=0;i<e.length;i++){if(t[s]==e[i][r])break;if(i===e.length-1)return!1}return!0}function i(e,t){if(!t)return!0;for(var r=0;r<t.length;r++)for(var s=0;s<e.length;s++){if(t[r]==e[s])break;if(s===e.length-1)return!1}return!0}r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return i}))},1:function(e,t){},2:function(e,t){},3:function(e,t){},8:function(e,t,r){e.exports=r("faee")},faee:function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var s=r("2b0e"),i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("b-container",[r("b-row",[e.breadcrumb.length>0?r("b-col",{attrs:{sm:"12"},domProps:{innerHTML:e._s(e.breadcrumb)}}):e._e(),r("b-col",{attrs:{lg:"3",md:"4"}},[r("div",{staticClass:"filter"},[r("h3",[e._v(" Подобрать товар ")]),r("b-form",{on:{submit:function(t){return t.preventDefault(),e.filteredProducts(t)},reset:function(t){return t.preventDefault(),e.resetFilters(t)}}},[r("b-form-group",{attrs:{label:"Категория"}},[r("b-form-checkbox-group",{attrs:{id:"checkbox-group-1",name:"categories",stacked:""},on:{change:e.filteredProducts},model:{value:e.filters.selected_categories,callback:function(t){e.$set(e.filters,"selected_categories",t)},expression:"filters.selected_categories"}},e._l(e.filters.categories,(function(t){return r("b-form-checkbox",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])})),1)],1),r("b-form-group",{attrs:{label:"Подкатегория"}},[r("b-form-checkbox-group",{attrs:{id:"checkbox-group-2",name:"subCategories",stacked:""},on:{change:e.filteredProducts},model:{value:e.filters.selected_subCategories,callback:function(t){e.$set(e.filters,"selected_subCategories",t)},expression:"filters.selected_subCategories"}},e._l(e.filters.subCategories,(function(t){return r("b-form-checkbox",{key:t.id,attrs:{value:t.name}},[e._v(" "+e._s(t.name)+" ")])})),1)],1),r("b-form-group",{attrs:{label:"Размер"}},[r("b-form-checkbox-group",{attrs:{id:"checkbox-group-3",name:"sizes",stacked:""},on:{change:e.filteredProducts},model:{value:e.filters.selected_sizes,callback:function(t){e.$set(e.filters,"selected_sizes",t)},expression:"filters.selected_sizes"}},e._l(e.filters.sizes,(function(t){return r("b-form-checkbox",{key:t.id,attrs:{value:t.name}},[e._v(" "+e._s(t.name)+" ")])})),1)],1),r("b-form-group",{attrs:{label:"Рост"}},[r("b-form-checkbox-group",{attrs:{id:"checkbox-group-3",name:"height",stacked:""},on:{change:e.filteredProducts},model:{value:e.filters.selected_height,callback:function(t){e.$set(e.filters,"selected_height",t)},expression:"filters.selected_height"}},e._l(e.filters.height,(function(t){return r("b-form-checkbox",{key:t.id,attrs:{value:t.name}},[e._v(" "+e._s(t.name)+" ")])})),1)],1),r("b-form-group",[r("div",{staticClass:"filter-range"},[r("b-form-input",{attrs:{type:"range",min:e.filters.price.min,max:e.filters.price.max},on:{change:e.filteredProducts},model:{value:e.filters.selected_price.min,callback:function(t){e.$set(e.filters.selected_price,"min",t)},expression:"filters.selected_price.min"}}),r("b-form-input",{attrs:{type:"range",min:e.filters.price.min,max:e.filters.price.max},on:{change:e.filteredProducts},model:{value:e.filters.selected_price.max,callback:function(t){e.$set(e.filters.selected_price,"max",t)},expression:"filters.selected_price.max"}})],1),r("span",{staticClass:"price-min"},[e._v(" "+e._s(e.filters.selected_price.min)+" ")]),r("span",{staticClass:"price-max"},[e._v(" "+e._s(e.filters.selected_price.max)+" ")])]),r("b-form-group",[r("b-btn",{staticClass:"btn btn-blue",attrs:{type:"submit"}},[e._v(" Применить ")])],1),e.isFilterActive?r("b-form-group",[r("b-btn",{staticClass:"btn btn-blue",attrs:{type:"reset"}},[e._v(" Сбросить фильтр ")])],1):e._e()],1)],1)]),r("b-col",{attrs:{lg:"9",md:"8"}},[r("div",{staticClass:"catalog"},[r("h1",[e._v(" "+e._s(e.category.name)+" ")]),e.products.length>0?r("b-row",{staticClass:"justify-content-between"},[r("div",[r("b-link",{staticClass:"sorted-link",class:{"sorted-link--active":"date"===e.sortType},attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.filteredProducts("date")}}},[e._v(" по новизне ")]),r("b-link",{staticClass:"sorted-link",class:{"sorted-link--active":"price"===e.sortType},attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.filteredProducts("price")}}},[e._v(" по цене ")]),r("b-link",{staticClass:"sorted-link",class:{"sorted-link--active":"rated"===e.sortType},attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.filteredProducts("rated")}}},[e._v(" по популярности ")])],1),r("div",[e._v(" "+e._s(e.products.length)+" товаров | Стр. "+e._s(e.page)+" / "+e._s(e.setPages)+" | "),e.page>1?r("b-link",{attrs:{href:"#"},on:{click:function(t){t.preventDefault(),e.page=e.page-1}}},[e._v("Предыдущая")]):e._e(),e._v(" | "),e.page<e.setPages?r("b-link",{attrs:{href:"#"},on:{click:function(t){t.preventDefault(),e.page=e.page+1}}},[e._v("Следующая")]):e._e()],1)]):e._e(),e.products.length>0?r("b-container",{staticClass:"p-0"},[r("b-row",e._l(e.filtered,(function(t){return r("b-col",{key:t.id,attrs:{md:"4",sm:"6"}},[r("div",{staticClass:"product"},[r("b-link",{attrs:{href:t.permalink}},[t.images.length>0?r("b-img",{attrs:{src:t.images[0].src,alt:t.images[0].alt}}):r("b-img",{attrs:{src:"/wp-content/plugins/woocommerce/assets/images/placeholder.png"}}),t.on_sale?r("b-badge",{attrs:{variant:"danger"}},[e._v(" Акция ")]):e._e()],1),t.sku.length?r("div",[e._v(" Код товара: "+e._s(t.sku)+" ")]):e._e(),r("b-link",{attrs:{href:t.permalink}},[e._v(" "+e._s(t.name)+" ")]),r("div",{domProps:{innerHTML:e._s(t.price_html)}})],1)])})),1)],1):r("p",[e._v(" Товаров не найдено ")])],1)])],1)],1)],1)},n=[],c=(r("4de4"),r("c740"),r("d81d"),r("fb6a"),r("2909")),a=r("025e"),o=r("69b0").default,l=new o({url:"https://m-malysh.ru/",consumerKey:"ck_882f64624ce39da4e32ba6797db5c14368f82a02",consumerSecret:"cs_abf9fc9ebef7255c861e493beb3363bcb31a2407",version:"wc/v3"}),u={name:"Category",data:function(){return{category:{},breadcrumb:{},products:[],sourcedProducts:[],page:1,pages:[],per_page:9,isFilterActive:!1,filters:{categories:[],selected_categories:[],subCategories:[],selected_subCategories:[],sizes:[],selected_sizes:[],height:[],selected_height:[],price:{min:null,max:null},selected_price:{min:null,max:null}},sortType:"date"}},computed:{setPages:function(){var e=this;return e.pages=Math.ceil(e.products.length/e.per_page),e.pages},filtered:function(){var e=(this.page-1)*this.per_page,t=e+this.per_page;return!!this.products.length&&this.products.slice(e,t)}},methods:{getProducts:function(){var e=this;l.get("products",{category:this.category.term_id}).then((function(t){console.log(t),e.sourcedProducts=t.data.sort((function(e,t){return new Date(t.date_modified)-new Date(e.date_modified)})),e.products=e.sourcedProducts.slice(),e.filters.price.min=Math.min.apply(Math,Object(c["a"])(e.products.slice().map((function(e){return e.price})))),e.filters.price.max=Math.max.apply(Math,Object(c["a"])(e.products.slice().map((function(e){return e.price})))),e.filters.selected_price.min=Math.min.apply(Math,Object(c["a"])(e.products.slice().map((function(e){return e.price})))),e.filters.selected_price.max=Math.max.apply(Math,Object(c["a"])(e.products.slice().map((function(e){return e.price}))))})).catch((function(e){return console.log(e),e})),l.get("products/categories",{orderby:"name",hide_empty:!0,parent:this.category.term_id}).then((function(t){e.filters.categories=t.data})).catch((function(e){return console.log(e),e})),l.get("products/attributes/1/terms").then((function(t){e.filters.subCategories=t.data})).catch((function(e){console.log(e.response.data)})),l.get("products/attributes/2/terms").then((function(t){console.log(t.data),e.filters.sizes=t.data})).catch((function(e){console.log(e.response.data)})),l.get("products/attributes/3/terms").then((function(t){e.filters.height=t.data})).catch((function(e){console.log(e.response.data)}))},filteredProducts:function(e){var t=this;this.isFilterActive=!0;var r=this.products.slice();if(this.filters.selected_categories.length&&(r=r.filter((function(e){return Object(a["a"])(e.categories,t.filters.selected_categories,"id")}))),this.filters.selected_subCategories.length&&(r=r.filter((function(e){if(e.attributes.length>0){var r=e.attributes.findIndex((function(e){return 1===e.id}));if(-1!==r){var s=Object(a["b"])(e.attributes[r].options,t.filters.selected_subCategories);if(s)return e}}}))),this.filters.selected_sizes.length&&(r=r.filter((function(e){if(e.attributes.length>0){var r=e.attributes.findIndex((function(e){return 2===e.id}));if(-1!==r){var s=Object(a["b"])(e.attributes[r].options,t.filters.selected_subCategories);if(s)return e}}}))),this.filters.selected_height.length&&(r=r.filter((function(e){if(e.attributes.length>0){var r=e.attributes.findIndex((function(e){return 3===e.id}));if(-1!==r){var s=Object(a["b"])(e.attributes[r].options,t.filters.selected_subCategories);if(s)return e}}}))),this.filters.selected_price.min>this.filters.selected_price.max){var s=this.filters.selected_price.max;this.filters.selected_price.max=this.filters.selected_price.min,this.filters.selected_price.min=s}if(r=r.filter((function(e){return e.price<=t.filters.selected_price.max&&e.price>=t.filters.selected_price.min})),e)switch(this.sortType=e,this.sortType){case"date":r.sort((function(e,t){return new Date(t.date_modified)-new Date(e.date_modified)}));break;case"price":r.sort((function(e,t){return e.price-t.price}));break;case"rated":r.sort((function(e,t){return e.rating_count-t.rating_count}));break;default:r.sort((function(e,t){return new Date(t.date_modified)-new Date(e.date_modified)}));break}this.products=r},resetFilters:function(){this.isFilterActive=!1,this.filters.selected_categories=[],this.filters.selected_subCategories=[],this.filters.selected_sizes=[],this.filters.selected_height=[],this.filters.selected_price.min=this.filters.price.min,this.filters.selected_price.max=this.filters.price.max,this.sortType="date",this.page=1,this.products=this.sourcedProducts.slice()}},created:function(){this.category=window.activeCategory,this.breadcrumb=window.breadcrumb,this.getProducts()}},f=u,d=r("2877"),p=Object(d["a"])(f,i,n,!1,null,"19f14aac",null),b=p.exports,h=r("5f5b");s["default"].use(h["a"]),s["default"].config.productionTip=!1,new s["default"]({render:function(e){return e(b)}}).$mount("#app")}});
//# sourceMappingURL=category.js.map